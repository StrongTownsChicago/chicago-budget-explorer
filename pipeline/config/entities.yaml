entities:
  city-of-chicago:
    name: "City of Chicago"
    entity_type: "city"
    status: "active"
    default_year: "fy2026"
    fiscal_year_start_month: 1  # January
    fiscal_year_start_day: 1
    property_tax_share_pct: 24.0
    color: "#0051A5"  # Chicago flag blue

    socrata:
      domain: "data.cityofchicago.org"
      datasets:
        fy2026:
          appropriations: "6694-f78c"  # Budget - 2026 Budget Ordinance - Appropriations
          revenue: "nydj-5nax"  # Budget - 2026 Budget Ordinance - Revenue
        fy2025:
          appropriations: "t59y-fr3k"  # Budget - 2025 Budget Ordinance - Appropriations
          revenue: "e5cq-t86i"  # Budget - 2025 Budget Ordinance - Revenue
        fy2024:
          appropriations: "x394-e874"  # Budget - 2024 Budget Ordinance - Appropriations
          revenue: "rmi8-cugu"  # Budget - 2024 Budget Ordinance - Revenue
        fy2023:
          appropriations: "xbjh-7zvh"  # Budget - 2023 Budget Ordinance - Appropriations
        fy2022:
          appropriations: "2cr6-8u6w"
        fy2021:
          appropriations: "6tbx-h7y2"
        fy2020:
          appropriations: "fyin-2vyd"
        fy2019:
          appropriations: "h9rt-tsn7"
        fy2018:
          appropriations: "6g7p-xnsy"
        fy2017:
          appropriations: "7jem-9wyw"
        fy2016:
          appropriations: "36y7-5nnf"
        fy2015:
          appropriations: "qnek-cfpp"
        fy2014:
          appropriations: "ub6s-xy6e"
        fy2013:
          appropriations: "b24i-nwag"
        fy2012:
          appropriations: "8ix6-nb7q"
        fy2011:
          appropriations: "drv3-jzqp"

    transform:
      department_column: "department_description"
      department_code_column: "department_number"
      fund_type_column: "fund_type"
      fund_code_column: "fund_code"
      fund_description_column: "fund_description"
      appropriation_authority_column: "appropriation_authority"
      appropriation_account_column: "appropriation_account"
      appropriation_account_description_column: "appropriation_account_description"

      # Department name normalization
      acronyms:
        oemc: "OEMC"
        bacp: "BACP"
        cdot: "CDOT"
        doit: "DoIT"
        copa: "COPA"
        ipra: "IPRA"

      # Simulation constraints
      non_adjustable_departments:
        - "FINANCE GENERAL"

      grant_funded_threshold: 0.9  # Departments >90% grant-funded get tighter constraints

      # Interfund transfer fund codes (to calculate net total)
      interfund_transfer_codes:
        - "0900"

      # Fund categorization for budget totals (City of Chicago specific)
      # Other entities (CPS, Park District) will define their own categories
      fund_categories:
        # Enterprise/airport funds (self-funded, excluded from operating budget)
        enterprise:
          - "Chicago O'Hare Airport Fund"
          - "Chicago Midway Airport Fund"

        # Pension/Annuity funds
        pension:
          - "Policemen's Annuity and Benefit Fund"
          - "Municipal Employees' Annuity and Benefit Fund"
          - "Firemen's Annuity and Benefit Fund"
          - "Laborers' and Retirement Board Annuity and Benefit Fund"

        # Debt service funds
        debt:
          - "Bond Redemption and Interest*"
          - "Library Note Redemption*"

        # Grant funds (pattern match)
        grant:
          - "*Grant*"

        # All other funds default to "operating" (Corporate Fund, Water, Sewer,
        # Vehicle Tax, Library, special revenue funds, etc.)

      # Funds to EXCLUDE from operating_appropriations (the headline budget number).
      # For Chicago, this is only airport funds (~$2.3B) since the city's reported
      # operating budget (~$16.6B) includes pensions, grants, debt, water, sewer.
      non_operating_funds:
        - "Chicago O'Hare Airport Fund"
        - "Chicago Midway Airport Fund"

      # Revenue categorization - multi-level strategy
      # 1. Check revenue_source for cross-fund patterns (property tax, TIF)
      # 2. For rows with populated revenue_category column, map that field
      # 3. For rows with empty revenue_category, map by fund_name
      # 4. Fallback: "uncategorized"
      revenue_categorization:
        # Map Socrata revenue_category values to our display categories.
        # These are populated only for Corporate Fund (fund_code 0100).
        category_field_mapping:
          "Transportation Taxes": "transportation_tax"
          "Municipal Public Utility Tax": "utility_tax"
          "Recreation Taxes": "recreation_tax"
          "Transaction Taxes": "transaction_tax"
          "Business Taxes": "business_tax"
          "Chicago Sales Tax / Home Rule Retailers' Occupation Tax": "sales_tax"
          "Charges for Services": "charges_for_services"
          "Fines, Forfeitures and Penalties": "fines_forfeitures"
          "Licenses, Permits, and Certificates": "licenses_permits"
          "Internal Service Earnings": "internal_earnings"
          "Interest Income": "interest_income"
          "Leases, Rentals and Sales": "leases_sales"
          "Municipal Parking": "parking_revenue"
          "Other Revenue": "other_local"
          "State Income Tax": "state_sharing"
          "Personal Property Replacement Tax": "state_sharing"
          "Municipal Auto Rental Tax": "state_sharing"
          "Reimbursements for City Services": "intergovernmental"
          "Proceeds and Transfers In": "proceeds_transfers"

        # Map fund_name to categories (for rows with empty revenue_category).
        # Wildcard patterns supported (e.g., "*Annuity*").
        fund_based_categories:
          airport_enterprise:
            - "Chicago O'Hare Airport Fund"
            - "Chicago Midway Airport Fund"
          water_sewer:
            - "Water Fund"
            - "Sewer Fund"
          pension_allocations:
            - "Municipal Employees' Annuity*"
            - "Policemen's Annuity*"
            - "Firemen's Annuity*"
            - "Laborers'*Annuity*"
          property_tax_funds:
            - "Bond Redemption and Interest*"
            - "Library Note Redemption*"
          vehicle_transportation:
            - "Vehicle Tax Fund"
            - "Motor Fuel Tax Fund"
          emergency_comm:
            - "Emergency Communication Fund"
          special_revenue:
            - "Special Events*"
            - "Garbage Collection Fund"
            - "CTA Real Property Transfer Tax Fund"
            - "Foreign Fire Insurance Tax Fund"
            - "Cannabis Regulation Tax*"
            - "Opioid Settlement Fund"
            - "Library Fund"

        # Revenue source patterns that override fund-based categorization.
        # Checked before fund_based_categories for pension/bond fund rows
        # where the revenue_source identifies the actual tax type.
        source_overrides:
          property_tax:
            - "Property Tax*"
            - "Tax Levy*"
          utility_tax:
            - "*Utility Tax*"
          tif:
            - "Tax Increment*"
            - "TIF*"

        # How each category maps to display name and revenue type
        display_categories:
          # TAX REVENUE
          property_tax:
            name: "Property Tax"
            revenue_type: "tax"
          sales_tax:
            name: "Sales Tax"
            revenue_type: "tax"
          state_sharing:
            name: "State Shared Revenue"
            revenue_type: "tax"
          utility_tax:
            name: "Utility Taxes"
            revenue_type: "tax"
          transaction_tax:
            name: "Transaction Taxes"
            revenue_type: "tax"
          transportation_tax:
            name: "Transportation Taxes"
            revenue_type: "tax"
          recreation_tax:
            name: "Recreation & Sin Taxes"
            revenue_type: "tax"
          business_tax:
            name: "Business Taxes"
            revenue_type: "tax"
          vehicle_transportation:
            name: "Vehicle & Motor Fuel Taxes"
            revenue_type: "tax"
          # FEE/CHARGE REVENUE
          fines_forfeitures:
            name: "Fines and Forfeitures"
            revenue_type: "fee"
          licenses_permits:
            name: "Licenses and Permits"
            revenue_type: "fee"
          charges_for_services:
            name: "Charges for Services"
            revenue_type: "fee"
          parking_revenue:
            name: "Parking Revenue"
            revenue_type: "fee"
          emergency_comm:
            name: "Telephone Surcharges"
            revenue_type: "fee"
          # ENTERPRISE REVENUE
          airport_enterprise:
            name: "Airport Revenue"
            revenue_type: "enterprise"
          water_sewer:
            name: "Water & Sewer Revenue"
            revenue_type: "enterprise"
          # INTERNAL/OTHER
          pension_allocations:
            name: "Pension Fund Allocations"
            revenue_type: "internal_transfer"
          interest_income:
            name: "Interest Income"
            revenue_type: "other"
          internal_earnings:
            name: "Internal Service Earnings"
            revenue_type: "internal_transfer"
          proceeds_transfers:
            name: "Proceeds & Transfers"
            revenue_type: "debt_proceeds"
          leases_sales:
            name: "Leases, Rentals & Sales"
            revenue_type: "other"
          intergovernmental:
            name: "Intergovernmental Revenue"
            revenue_type: "other"
          special_revenue:
            name: "Special Revenue Funds"
            revenue_type: "other"
          property_tax_funds:
            name: "Debt Service Funds"
            revenue_type: "debt_proceeds"
          other_local:
            name: "Other Local Revenue"
            revenue_type: "other"
          tif:
            name: "TIF Surplus"
            revenue_type: "other"
          uncategorized:
            name: "Uncategorized Revenue"
            revenue_type: "other"

      # Column mappings for revenue dataset
      revenue_columns:
        source_column: "revenue_source"
        fund_column: "fund_name"

  # Future entities (coming soon)
  chicago-public-schools:
    name: "Chicago Public Schools"
    entity_type: "school_district"
    status: "coming_soon"
    property_tax_share_pct: 52.0
    color: "#CE1126"

  chicago-park-district:
    name: "Chicago Park District"
    entity_type: "special_district"
    status: "coming_soon"
    property_tax_share_pct: 8.0
    color: "#2E7D32"

  chicago-transit-authority:
    name: "Chicago Transit Authority"
    entity_type: "transit_authority"
    status: "coming_soon"
    property_tax_share_pct: 0
    color: "#0066B3"

  chicago-city-colleges:
    name: "City Colleges of Chicago"
    entity_type: "community_college"
    status: "coming_soon"
    property_tax_share_pct: 6.0
    color: "#FF6F00"
