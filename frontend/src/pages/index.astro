---
import BaseLayout from "../layouts/BaseLayout.astro";
import { loadBudgetData } from "@/lib/data-loader";
import { formatCurrency } from "@/lib/format";

const data = await loadBudgetData("city-of-chicago", "fy2025");
const totalBudget = data.metadata.total_appropriations;
const departmentCount = data.appropriations.by_department.length;
const fiscalYear = data.metadata.fiscal_year_label;
---

<BaseLayout
  title="Home"
  description={`Explore and simulate Chicago's ${formatCurrency(totalBudget)} operating budget`}
>
  <div class="max-w-4xl mx-auto">
    <!-- Hero Section -->
    <section class="text-center py-12">
      <h1 class="text-5xl font-bold text-gray-900 mb-4">
        Where does Chicago spend {formatCurrency(totalBudget)}?
      </h1>
      <p class="text-xl text-gray-600 mb-8">
        Explore the City's budget interactively. Simulate changes. Understand trade-offs.
      </p>
      <div class="flex gap-4 justify-center">
        <a href="/entity/city-of-chicago" class="btn-primary">
          Explore the Budget
        </a>
        <a href="/entity/city-of-chicago/simulate" class="btn-secondary">
          Try the Simulator
        </a>
      </div>
    </section>

    <!-- Quick Stats -->
    <section class="py-12 border-t border-gray-200">
      <h2 class="text-3xl font-bold text-center mb-8">Quick Facts</h2>
      <div class="grid md:grid-cols-2 gap-6">
        <div class="bg-white p-6 rounded-lg shadow">
          <div class="text-4xl font-bold text-chicago-blue mb-2">{formatCurrency(totalBudget)}</div>
          <div class="text-gray-600">Total Operating Budget ({fiscalYear})</div>
        </div>
        <div class="bg-white p-6 rounded-lg shadow">
          <div class="text-4xl font-bold text-chicago-blue mb-2">{departmentCount}</div>
          <div class="text-gray-600">City Departments</div>
        </div>
      </div>
    </section>

    <!-- About Preview -->
    <section class="py-12 border-t border-gray-200">
      <h2 class="text-3xl font-bold mb-6">What is this?</h2>
      <div class="prose max-w-none">
        <p class="text-lg text-gray-700 mb-4">
          The Chicago Budget Explorer is the <strong>only free, open, interactive tool</strong> for
          exploring the City of Chicago's operating budget. Built by Strong Towns Chicago, it makes
          budget data transparent and accessible.
        </p>
        <p class="text-gray-700 mb-4">
          Unlike read-only dashboards, you can <strong>simulate budget changes</strong> to understand
          trade-offs. Want to know what happens if you increase public safety funding while reducing
          administrative costs? Try it yourself.
        </p>
        <div class="mt-6">
          <a href="/about" class="btn-link">
            Learn more about this project â†’
          </a>
        </div>
      </div>
    </section>

  </div>
</BaseLayout>
